{"id":8305,"name":"HubSpotAuth","userId":197288,"accountId":176546,"createdDate":"2019-09-17T10:35:53Z","steps":[{"id":84499,"onSuccess":[],"onFailure":[],"name":"SendOptions","type":"script","properties":{"body":"let res;\n\nif(trigger.args.request.query.error !== undefined){\n  res = {\n      \"cards\": [{\n          \"id\": \"check2\",\n          \"card\": {\n              \"type\": \"ACTION\",\n              \"heading\": \"Error:  Authentication Failed\",\n              \"listContent\": [\n                  trigger.args.request.query.error\n              ],\n              \"icon\": \"WARNING\"\n          }\n      }]\n  };\n  done({\n    statusCode: 401,\n    res: res\n  });\n}\n\n\nlet code = trigger.args.request.query.code;\nlet siteName = trigger.args.request.query.state;\nlet redirect_uri = trigger.args.request.query.redirect_uri;\nlet client_info = JSON.parse(trigger.args.request.query.client_info);\n\nlet client_id = client_info.client_id;\nlet client_secret = client_info.client_secret;\n\n\nres = {\n    url: 'https://api.hubapi.com/oauth/v1/token',\n    method:\"POST\",\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type' : 'application/x-www-form-urlencoded'\n    },\n    form: {\n      'grant_type' : 'authorization_code',\n      'code' : code,\n      'client_id': client_id,\n      'client_secret':client_secret,\n      'redirect_uri' : redirect_uri\n    },\n    \"redirect_uri\": redirect_uri,\n    \"site_name\": siteName,\n    urlParams:{}\n  };\n\ndone({\n  statusCode: 200,\n  result: res\n});\n\n  "}}],"triggers":[{"id":7258,"onSuccess":["SendOptions"],"onFailure":[],"type":"manual","async":true,"name":"trigger","properties":{}}],"method":"GET","uri":"/hubspot/auth","engine":"v1","active":true,"api":"GET /hubspot/auth","debugLoggingEnabled":true,"singleThreaded":false,"configuration":[]}